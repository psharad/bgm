:javascript
  $(document).ready(function () {
    $.getJSON('/autocomplete_friends', function(data) {
      $.each(data, function(k,v){
        friendsList.push(v)
      });
      var cache = {}, lastXhr;
      $("#autocomp_member").autocomplete({
        source: friendsList,     
        minLength: 1,
        select: function(event, ui) {
          $("#autocomp_member").val(ui.item.value);
          $("#pop_member_form").submit();
        }
      });    
    });
  });
  
%tr
  %td.text
    %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
      %tr
        %td{:align => "center", :style => "padding: 20px 0px;"}
          %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "759"}
            %tr
              %td{:background => "/images/member-profile2.jpg", :height => "423", :style => "background-repeat:no-repeat;", :valign => "top", :width => "417"}
                %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
                  %tr
                    %td{:width => "25"}  
                    %td
                      - form_tag({:action => :populate_member}, :id => 'pop_member_form') do
                        %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
                          %tr
                            %td{:height => "20"}  
                          %tr
                            %td.text3{:align => "left", :style => "font-size:17px; line-height:18px;"}
                              MEMBER PROFILE
                              %br/
                              %span.style1 All fields are required.
                          %tr
                            %td{:height => "24"}
                          %tr
                            %td{:align => "left"}
                              = text_field_tag 'auto_member', nil, :id => "autocomp_member", :onblur => "this.value=!this.value?'Search Friend':this.value;", :onclick => "this.value='';", :onfocus => "this.select()", :style => "border:none; width:360px; height:23px; background:none;", :type => "text", :value => "Search Friend",:class => 'required'
                              = hidden_field_tag 'memcount', @member_count
                              = image_tag 'ajax-loader.gif', {:id => 'pop_loader', :style => "display:none"}
                      %br
                        - form_tag({:action => :create_member}, :html => {:method => :get}) do
                          %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
                            %tr
                              %td{:height => "0"}
                            %tr
                              %td{:align => "left"}
                                = text_field_tag "member[#{@member_count}][email]", @member.email,:id=>"member_email", :onblur => "this.value=!this.value?'EMAIL':this.value;", :onclick => "this.value='';", :onfocus => "this.select()", :style => "border:none; width:360px; height:23px; background:none;", :type => "text", :value => "Email",:class => 'required'
                            %tr
                              %td{:height => "10"}
                            %tr
                              %td{:align => "left"}
                                = select_tag 'member[#{@member_count}][sex]', options_for_select(['Male', 'Female'], @member.sex), :onblur => "this.value=!this.value?'SEX':this.value;", :onfocus => "this.select()", :style => "border:none; width:190px; height:23px;margin-left:170px; background:none;", :type => "text", :value => "SEX", :class => 'required'

                            %tr
                              %td{:height => "12"}
                            %tr
                              %td{:align => "left"}
                                = select_tag 'member[#{@member_count}][age]', options_for_select(list_size_group('age'), @member.age), :onblur => "this.value=!this.value?'AGE':this.value;", :onfocus => "this.select()", :style => "border:none; width:190px; height:23px;margin-left:170px; background:none;", :type => "text", :value => "AGE", :class => 'required'
                            %tr
                              %td{:height => "15"}
                            %tr
                              %td{:align => "left"}
                                - unless @sp.fb_ids.nil? || @sp.fb_ids[@member_count.to_s].nil?
                                  = image_tag(graph_picture(@sp.fb_ids[@member_count.to_s]['fbid']))
                                  = hidden_field_tag "fb_ids[#{@member_count}][fbid]", @sp.fb_ids[@member_count.to_s]['fbid']


                            %tr
                              %td{:height => "52"}
                            %tr
                              %td{:align => "left", :style => "padding-left:165px;"}
                                =# image_tag 'local_offer_spacer.png', :height => '105', :width => '1'
                                = hidden_field_tag 'memcount', @member_count
                                = hidden_field_tag 'from_facebook', true
                                - if (@sp.group['size'].to_i - 1) == (@member_count + 1)
                                  = submit_tag 'No more members', :id => 'no_more_member_submit', :disabled => true, :class => 'disabled'
                                - else
                                  = submit_tag 'Continue', :id => 'member_submit', :disabled => true, :class => 'disabled'
                            %tr
                              %td{:height => "5"}
                            %tr
                              %td{:align => "left", :style => "padding-left:165px;"}
                                = submit_tag 'Back', :id => 'back_member_submit'
